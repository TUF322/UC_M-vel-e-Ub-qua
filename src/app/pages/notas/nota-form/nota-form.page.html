<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/notas"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ isEditMode ? 'Editar Nota' : 'Nova Nota' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="salvar()" [disabled]="loading">
        <ion-icon slot="icon-only" name="checkmark"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">{{ isEditMode ? 'Editar Nota' : 'Nova Nota' }}</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="form-container">
    <!-- Loading -->
    <div *ngIf="loading" class="loading-container">
      <ion-spinner></ion-spinner>
      <p>A processar...</p>
    </div>

    <!-- Formulário -->
    <form *ngIf="!loading" (ngSubmit)="salvar()">
      <ion-item>
        <ion-label position="stacked">Título *</ion-label>
        <ion-input
          [(ngModel)]="nota.titulo"
          name="titulo"
          placeholder="Digite o título da nota"
          required
        ></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Conteúdo *</ion-label>
        <ion-textarea
          [(ngModel)]="nota.conteudo"
          name="conteudo"
          placeholder="Digite o conteúdo da nota"
          rows="15"
          required
        ></ion-textarea>
      </ion-item>

      <ion-item>
        <ion-label>
          <h2>Proteger com senha</h2>
          <p *ngIf="!mostrarSenha">Adicione uma senha para proteger esta nota</p>
          <p *ngIf="mostrarSenha" class="protegida-info">
            <ion-icon name="lock-closed" color="warning"></ion-icon>
            Esta nota está protegida por senha
          </p>
        </ion-label>
        <ion-toggle [checked]="mostrarSenha" (ionChange)="toggleProtecao($event)" name="protegida"></ion-toggle>
      </ion-item>

      <div class="form-actions">
        <ion-button expand="block" type="submit" color="primary" [disabled]="loading">
          <ion-icon slot="start" name="checkmark"></ion-icon>
          {{ isEditMode ? 'Atualizar' : 'Criar' }}
        </ion-button>
        <ion-button expand="block" fill="outline" (click)="cancelar()" [disabled]="loading">
          <ion-icon slot="start" name="close"></ion-icon>
          Cancelar
        </ion-button>
      </div>
    </form>
  </div>
</ion-content>

